# Canary SEFI
<img src="https://github.com/NeoSunJZ/Canary_Master/blob/main/logo.png?raw=true" width="200" alt="">

[![standard-readme compliant](https://img.shields.io/badge/readme%20style-standard-brightgreen.svg?style=flat-square)](https://github.com/RichardLitt/standard-readme)

[English](https://github.com/NeoSunJZ/Canary_Master/blob/main/readme.md)

## æ–‡æ¡£

**æ¬²å¼€å§‹ä½¿ç”¨Canaryï¼Œè¯·å‚è€ƒæˆ‘ä»¬çš„ ğŸ“–æ–‡æ¡£ ğŸ‘‰ğŸ‘‰[Canary æ–‡æ¡£(ä¸­æ–‡)](https://neosunjz.github.io/Canary/)ğŸ‘ˆğŸ‘ˆ**

æ‚¨å½“å‰æ‰€é˜…è¯»çš„æ–‡æ¡£ç³»åˆæœŸç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å¹¶ä¸å®Œæ•´ï¼Œä½œè€…æ­£åœ¨å°½åŠ›ç¼–è¾‘å¹¶å°†æŒç»­æ›´æ–°ã€‚æˆ‘ä»¬å°†å°½å¿«æä¾›å®Œæ•´çš„æ–‡æ¡£ï¼Œä»¥åŠæ–‡æ¡£çš„è‹±æ–‡ç‰ˆã€‚å¦‚æ‚¨æœ‰ç–‘é—®ï¼Œè¯·å’¨è¯¢jiazheng.sun@bit.edu.cnä»¥è·å–è¯¦ç»†ä¿¡æ¯ã€‚

## ç®€ä»‹

SEFIæ˜¯ä¸€ä¸ªè¯„ä¼°åŸºäºæ·±åº¦å­¦ä¹ çš„å›¾åƒè¯†åˆ«æ¨¡å‹ç¨³å¥æ€§çš„æ¡†æ¶ã€‚

å®ƒä½¿ç”¨é€‰å®šçš„æ”»å‡»æ–¹æ³•åŸºäºé€‰å®šçš„æ¨¡å‹ç”Ÿæˆå¯¹æŠ—æ€§æ ·æœ¬ï¼Œå¹¶ä½¿ç”¨è¿™äº›å¯¹æŠ—æ€§æ ·æœ¬æ”»å‡»æ‚¨æƒ³è¦çš„ä»»ä½•æ¨¡å‹ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå®ƒå°†æ”¶é›†åŒ…æ‹¬å¤šä¸ªè¯„ä¼°æŒ‡æ ‡çš„æ•°æ®ï¼Œä»¥æ­¤è¯„ä¼°äººå·¥æ™ºèƒ½æ¨¡å‹ç¨³å¥æ€§å’Œæ”»å‡»æ–¹æ³•æœ‰æ•ˆæ€§ï¼ŒåŒæ—¶å°è¯•æ‰¾åˆ°æœ€ä½³é˜²å¾¡è§£å†³æ–¹æ¡ˆã€‚

å®ƒè¿˜æä¾›äº†ä¸€ä¸ªåŒ…å«å¤šä¸ªæ¨¡å‹ã€SOTAæ”»å‡»æ–¹æ³•å’Œé˜²å¾¡æ–¹æ³•çš„å·¥å…·åŒ…ï¼Œå¹¶å…è®¸ç”¨æˆ·è‡ªå·±è¿›è¡Œæ›´å¤šé›†æˆã€‚

SEFIç”±åŒ—äº¬ç†å·¥å¤§å­¦ï¼ˆBITï¼‰ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ï¼ˆCyberspace Science & Technologyï¼‰çš„ç ”ç©¶äººå‘˜åˆ›å»ºå’Œç»´æŠ¤ã€‚

<img src="https://github.com/NeoSunJZ/Canary_Master/blob/main/framework_structure.png?raw=true" width="800" alt="">

## åŠŸèƒ½

### æˆ‘ä»¬æ”¯æŒäº†å“ªäº›æ¨¡å‹ï¼Ÿ

æˆ‘ä»¬å·²ç»æ”¯æŒäº†4ç§æ•°æ®é›†ä¸Šçš„15ç§æ¨¡å‹ï¼Œå…¶ä¸­ImageNetæ•°æ®é›†çš„15ç§æ¨¡å‹éƒ½æ˜¯å¯ç”¨çš„ã€‚æˆ‘ä»¬å¸Œæœ›å¤§å®¶å‚ä¸å®Œå–„æˆ‘ä»¬çš„æ¨¡å‹åº“ï¼Œåˆ†äº«è‡ªå·±çš„æ¨¡å‹ç»“æ„ä¸æƒé‡ä¿¡æ¯ä»¥å¸®åŠ©æ›´å¤šçš„äºº

æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªå…¬å¼€çš„æ¨¡å‹æƒé‡ä»“åº“ï¼Œä½äºï¼šhttps://github.com/NeoSunJZ/Canary_SEFI_Lib_Weight

| æ¨¡å‹                  | å­ç»“æ„          | æ•°æ®é›†        | å®Œå…¨å¯ç”¨  | æ¥æº                  | æ˜¯å¦æ”¯æŒGard-CAM | æƒé‡åˆ†å‘       | Top-1 Acc |
| --------------------- | --------------- | ------------- | --------- | --------------------- | ---------------- | -------------- | --------- |
| **LeNetV5**           | N/A             | Fashion-MNIST | Come Soon       | [CNN-for-Fashion-MNIST](https://github.com/wzyjsha-00/CNN-for-Fashion-MNIST) | Planned       | âœ”SEFI-LW          |           |
| **AlexNet**           | N/A             | Fashion-MNIST | Come Soon       | [CNN-for-Fashion-MNIST](https://github.com/wzyjsha-00/CNN-for-Fashion-MNIST) | Planned       | âœ”SEFI-LW          | 92.19%    |
| **AlexNet**           | N/A             | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **VGG**               | vgg16_bn        | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **VGG**               | vgg16_bn        | CIFAR-10      | âœ”               | [PyTorch CIFAR10](https://github.com/huyvnphan/PyTorch_CIFAR10) | âœ”             | âœ”SEFI-LW          |           |
| **VGG**               | vgg16_bn        | CIFAR-100     | âœ”               | [PyTorch CIFAR Models](https://github.com/chenyaofo/pytorch-cifar-models) | Planned       | âœ”SEFI-LW          |           |
| **GoogLeNet**         | N/A             | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **GoogLeNet**         | N/A             | CIFAR-10      | âœ”               | [PyTorch CIFAR10](https://github.com/huyvnphan/PyTorch_CIFAR10) | âœ”             | âœ”SEFI-LW          |           |
| **InceptionV3**       | N/A             | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **InceptionV3**       | N/A             | CIFAR-10      | âœ”               | [PyTorch CIFAR10](https://github.com/huyvnphan/PyTorch_CIFAR10) | âœ”             | âœ”SEFI-LW          |           |
| **ResNet**            | resnet50        | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **ResNet**            | resnet50        | CIFAR-10      | âœ”               | [PyTorch CIFAR10](https://github.com/huyvnphan/PyTorch_CIFAR10) | âœ”             | âœ”SEFI-LW          |           |
| **ResNet**            | resnet56        | CIFAR-100     | Come Soon       | [PyTorch CIFAR Models](https://github.com/chenyaofo/pytorch-cifar-models) | Planned       | âœ”SEFI-LW          | 72.63%    |
| **ResNet**            | resnet19light   | Fashion-MNIST | Come Soon       | [CNN-for-Fashion-MNIST](https://github.com/wzyjsha-00/CNN-for-Fashion-MNIST) | Planned       | âœ”SEFI-LW          |           |
| **DenseNet**          | densenet161*    | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **DenseNet**          | densenet161     | CIFAR-10      | âœ”               | [PyTorch CIFAR10](https://github.com/huyvnphan/PyTorch_CIFAR10) | âœ”             | âœ”SEFI-LW          |           |
| **SqueezeNet**        | squeezenet1_1   | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **MobileNetV3**       | v3_large        | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **MobileNetV2**       | N/A             | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **MobileNetV2**       | N/A             | CIFAR-10      | âœ”               | [PyTorch CIFAR10](https://github.com/huyvnphan/PyTorch_CIFAR10) | Planned       | âœ”SEFI-LW          |           |
| **MobileNetV2**       | v2_x1_0         | CIFAR-100     | âœ”               | [PyTorch CIFAR Models](https://github.com/chenyaofo/pytorch-cifar-models) | Planned       | âœ”SEFI-LW          | 73.61%    |
| **ShuffleNetV2**      | v2_x2_0         | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **ShuffleNetV2**      | v2_x2_0         | CIFAR-10      | Come Soon       | [PyTorch CIFAR Models](https://github.com/chenyaofo/pytorch-cifar-models) | N/A           | Waiting Upload    |           |
| **ShuffleNetV2**      | v2_x2_0         | CIFAR-100     | âœ”               | [PyTorch CIFAR Models](https://github.com/chenyaofo/pytorch-cifar-models) | Planned       | âœ”SEFI-LW          |           |
| **MNASNet**           | mnasnet1_3      | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **EfficientNetV2**    | v2_s            | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **VisionTransformer** | vit_b_32        | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **RegNet**            | y_8gf           | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **SwinTransformer**   | swin_s          | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **ConvNext**          | convnext_base   | ImageNet      | âœ”               | Torchvision                                                  | âœ”             | âœ”Official         |           |
| **WideResNet**        | wideresnet34_10 | CIFAR-10      | Come Soon       | [PyTorch CIFAR10](https://github.com/huyvnphan/PyTorch_CIFAR10) | âœ”             | Waiting Upload    |           |

### æˆ‘ä»¬æ”¯æŒäº†å“ªäº›æ”»å‡»æ–¹æ³•ï¼Ÿ

æˆ‘ä»¬æ”¯æŒäº†22ç§å¸¸è§çš„æ”»å‡»æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š

| æ”»å‡»æ–¹æ³•                                     | æ–¹æ³•ç±»å‹               | æ”»å‡»é€”å¾„           | ä¸æ”¯æŒçš„æ¨¡å‹              | é»˜è®¤å‚æ•°é€‚é…æè¿°            |
| -------------------------------------------- | ---------------------- | ------------------ | ------------------------- | --------------------------- |
| **FGSM**                                     | White-Box              | Gradient           | None                      | Yes, applicable to ImageNet |
| **JSMA**                                     | White-Box              | Gradient           | None                      | Yes, applicable to ImageNet |
| **DeepFool**                                 | White-Box              | Gradient           | None                      | Yes, applicable to ImageNet |
| **I-FGSM (****BIM****)**                     | White-Box              | Gradient           | None                      | Yes, applicable to ImageNet |
| **C&W Attack**                               | White-Box              | Gradient           | None                      | Yes, applicable to ImageNet |
| **Projected** **Gradient Descent** **(PGD)** | White-Box              | Gradient           | None                      | Yes, applicable to ImageNet |
| **MI-FGSM (MIM)**                            | Transferable Black-box | Transfer, Gradient | None                      | Yes, applicable to ImageNet |
| **SI-FGSM (SIM)**                            | Transferable Black-box | Transfer, Gradient | None                      | Yes, applicable to ImageNet |
| **NI-FGSM (NIM)**                            | Transferable Black-box | Transfer, Gradient | None                      | Yes, applicable to ImageNet |
| **VMI-FGSM (VMIM)**                          | Transferable Black-box | Transfer, Gradient | None                      | Yes, applicable to ImageNet |
| **Elastic-Net Attack (EAD)**                 | White-Box              | Gradient           | None                      | Yes, applicable to ImageNet |
| **SSAH**                                     | White-Box              | Gradient           | InceptionV3ã€SwinTã€ViT   | Yes, applicable to ImageNet |
| **One-pixel Attack (OPA)**                   | Black-Box              | Query, Score       | Not tested                | No                          |
| **Local Search Attack (LSA)**                | Black-Box              | Query, Score       | None                      | Yes, applicable to ImageNet |
| **Boundary Attack (BA)**                     | Black-Box              | Query, Decision    | None                      | Yes, applicable to ImageNet |
| **Spatial Attack (SA)**                      | Black-Box              | Query              | None                      | Yes, applicable to ImageNet |
| **Hop Skip Jump Attack (HSJA)**              | Black-Box              | Query, Decision    | None                      | Yes, applicable to ImageNet |
| **Gen Attack (GA)**                          | Black-Box              | Query, Score       | None                      | Yes, applicable to ImageNet |
| **SPSA**                                     | Black-Box              | Query, Score       | None                      | Yes, applicable to ImageNet |
| **Zeroth-Order** **Optimization** **(ZOO)**  | Black-Box              | Query, Score       | Not tested                | No                          |
| **AdvGan**                                   | Black-Box              | Query, Score       | None                      | Yes, applicable to ImageNet |
| **TREMBA**                                   | Black-Box              | Query, Score       | GoogLeNetã€EfficientNetV2 | Yes, applicable to ImageNet |

æˆ‘ä»¬æ­£åœ¨è¿›ä¸€æ­¥å¯»æ‰¾æ›´å¤šä¼˜ç§€å’Œç»å…¸çš„æ”»å‡»æ–¹æ³•ä»¥åŠ å…¥æˆ‘ä»¬çš„åº“ï¼Œå¦‚æœä½ æ˜¯æ–¹æ³•çš„ä½œè€…ï¼Œæ¬¢è¿è´¡çŒ®ä½ çš„æ–¹æ³•ã€‚ä¸€äº›æœªç»å®Œå…¨æµ‹è¯•çš„æ–¹æ³•å¯èƒ½æ²¡æœ‰æ˜¾ç¤ºåœ¨ä¸Šè¡¨ä¸­ï¼Œä½†å®ƒå¯èƒ½ä¼šæå‰å‡ºç°åœ¨ä»£ç ä¸­ï¼Œå¦‚æœå®ƒæœªèƒ½å‡ºç°åœ¨ä¸Šè¿°åˆ—è¡¨ä¸­è¯´æ˜å®ƒå¯èƒ½å¹¶ä¸ç¨³å®šä¹Ÿæš‚æ—¶æ²¡æœ‰å¾—åˆ°ç¨³å®šçš„æ”¯æŒã€‚

### æˆ‘ä»¬æ”¯æŒäº†å“ªäº›é˜²å¾¡æ–¹æ³•ï¼Ÿ(å®éªŒæ€§çš„)

æ•´ä¸ªé˜²å¾¡æ¨¡å—ç›®å‰éƒ½æ˜¯å®éªŒæ€§çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯èƒ½å¹¶ä¸ç¨³å®šã€‚

æˆ‘ä»¬æ”¯æŒäº†8ç§å¸¸è§çš„é˜²å¾¡æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š

| é˜²å¾¡æ–¹æ³• | æ–¹æ³•ç±»å‹             | ä¸æ”¯æŒçš„æ¨¡å‹ | é»˜è®¤å‚æ•°é€‚é…æè¿° |
| -------- | -------------------- | ------------ | ---------------- |
| NAT      | Adversarial Training |              |                  |
| Mart     | Adversarial Training |              |                  |
| Natural  | Adversarial Training |              |                  |
| Trades   | Adversarial Training |              |                  |
| Jpeg     | Image Processing     |              |                  |
| Quantize | Image Processing     |              |                  |
| TVM      | Image Processing     |              |                  |
| Quilting | Image Processing     |              |                  |

æˆ‘ä»¬æ­£åœ¨è¿›ä¸€æ­¥å¯»æ‰¾æ›´å¤šä¼˜ç§€å’Œç»å…¸çš„é˜²å¾¡æ–¹æ³•ä»¥åŠ å…¥æˆ‘ä»¬çš„åº“ï¼Œå¦‚æœä½ æ˜¯æ–¹æ³•çš„ä½œè€…ï¼Œæ¬¢è¿è´¡çŒ®ä½ çš„æ–¹æ³•ã€‚ä¸€äº›æœªç»å®Œå…¨æµ‹è¯•çš„æ–¹æ³•å¯èƒ½æ²¡æœ‰æ˜¾ç¤ºåœ¨ä¸Šè¡¨ä¸­ï¼Œä½†å®ƒå¯èƒ½ä¼šæå‰å‡ºç°åœ¨ä»£ç ä¸­ï¼Œå¦‚æœå®ƒæœªèƒ½å‡ºç°åœ¨ä¸Šè¿°åˆ—è¡¨ä¸­è¯´æ˜å®ƒå¯èƒ½å¹¶ä¸ç¨³å®šä¹Ÿæš‚æ—¶æ²¡æœ‰å¾—åˆ°ç¨³å®šçš„æ”¯æŒã€‚

### æˆ‘ä»¬æ”¯æŒé‡‡é›†å“ªäº›æ•°æ®ï¼Ÿ

æˆ‘ä»¬æ”¯æŒä»¥ä¸‹å››ç±»æŒ‡æ ‡çš„å®Œå…¨é‡‡é›†ã€‚é’ˆå¯¹æŒ‡æ ‡çš„å…·ä½“æ„ä¹‰è¯·å‚è€ƒæˆ‘ä»¬çš„è®ºæ–‡3.1ç« èŠ‚æˆ–ç”¨æˆ·æ‰‹å†Œã€‚

#### æ¨¡å‹èƒ½åŠ›è¯„ä¼°æŒ‡æ ‡ (Model capability measurement metrics)
- å¹²å‡€æ ·æœ¬æ­£ç¡®ç‡ (Clear Accuracy, CA)
- å¹²å‡€æ ·æœ¬F1åˆ†æ•° (Clear F1, CF)
- å¹²å‡€æ ·æœ¬å¹³å‡æ­£ç¡®åˆ†ç±»ç½®ä¿¡åº¦ (Clear Confidence, CC)

#### æ”»å‡»æ•ˆæœè¯„ä¼°æŒ‡æ ‡ (Attack effectiveness measurement metrics)
- è¯¯åˆ†ç±»æ¯”ä¾‹ (Misclassification Ratio, MR) /  æ”»å‡»å‡†ç¡®æ€§ (Targeted Attack Success, TAS)
- å¯¹æŠ—æ ·æœ¬ç½®ä¿¡åç§» (Average Confidence Change, ACC): æŠ—ç±»å¹³å‡ç½®ä¿¡å¢é«˜(Average Increase in Adversarial-class Confidence, AIAC)ã€çœŸå®ç±»å¹³å‡ç½®åº¦é™ä½(Average Reduction in True-class Confidence, ARTC)+
- å¯¹æŠ—æ ·æœ¬æ¨¡å‹å…³æ³¨åŒºåŸŸåç§» (Average Class Activation Mapping Change, ACAMC)
- å¯¹æŠ—æ ·æœ¬å¯è§‚æµ‹è½¬ç§»ç‡ (Observable Transfer Rate, OTR)

#### æ”»å‡»ä»£ä»·è¯„ä¼°æŒ‡æ ‡ (Cost of attack measurement metrics)
- æ”»å‡»è€—æ—¶ä»£ä»· (Calculation Time Cost, CTC)
- æ”»å‡»æŸ¥è¯¢é‡ä»£ä»· (Query Number Cost, QNC)
- å¹³å‡èŒƒæ•°è·ç¦» (Average Norm Distortion, AND): æœ€å¤§åƒç´ è·ç¦»(Average Maximum Distortion, AMD)ã€å¹³å‡æ¬§å¼è·ç¦»(Average Euclidean Distortion, AED)ã€åƒç´ å˜åŒ–æ¯”ä¾‹(Average Pixel Change Ratio, APCR)
- å¹³å‡é¢‘åŸŸæ¬§å¼è·ç¦» (Average Euclidean Distortion in Frequency Domain, AED-FD)
- å¹³å‡ç‰¹å¾ç›¸ä¼¼æ€§ (Average Metrics Similarity, AMS): å¹³å‡æ·±åº¦ç‰¹å¾ç›¸ä¼¼æ€§(Average Deep Metrics Similarity, ADMS)ã€å¹³å‡ä½å±‚ç‰¹å¾ç›¸ä¼¼æ€§(Average Low-level MetricsSimilarity, ALMS)

#### é˜²å¾¡æ•ˆæœè¯„ä¼°æŒ‡æ ‡ (Effectiveness of defense measurement metrics)
- æ¨¡å‹èƒ½åŠ›æŸå¤± (Model Capability Variance, MCV): å‡†ç¡®ç‡å·®å¼‚ï¼ˆ(Accuracy Variance, AccV)ã€F1-Scoreå·®å¼‚(F1-Score Variance, F1V)ã€å¹³å‡ç½®ä¿¡å·®å¼‚(Confidence Variance, ConfV)
- çŸ«æ­£/ç‰ºç‰²æ¯”ç‡ (Rectify/Sacrifice Ratio, RR/SR)
- æ”»å‡»èƒ½åŠ›å¼±åŒ–(Attack Capability Variance, ACV): MRå·®å¼‚(MR Variance, MRV)ã€ANDå·®å¼‚(AND Variance, ANDV)ã€AMSå·®å¼‚(AMS Variance, AMSV)
- å¯¹æŠ—ç½®ä¿¡åç§»(Average Adversarial Confidence Change, AACC): å¯¹æŠ—ç±»å¹³å‡ç½®ä¿¡é™ä½(Average Reduction in Adversarial-class Confidence, ARAC)ã€çœŸå®ç±»å¹³å‡ç½®åº¦å‡é«˜(Average Increase in True-class Confidence, AITC)

## ç»´æŠ¤è€…

[@NeoSunJz](https://github.com/NeoSunJz).

## è´¡çŒ®è€…

æˆ‘ä»¬çš„ä¸»è¦è´¡çŒ®è€…æ˜¯ï¼š**å­™å®¶æ­£ï¼ˆJiazheng Sunï¼‰ã€Li Chenã€Chenxiao Xiaã€Da Zhangã€ Rong Huangã€Zhi Quã€Wenqi Xiong**

æˆ‘ä»¬æ ¼å¤–è‡´è°¢ï¼š**Jun Zheng ã€Yuâ€™an Tan**

## è®¸å¯è¯

[Apache 2.0](LICENSE) Â© åŒ—äº¬ç†å·¥å¤§å­¦
